<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<title>لعبة الشطرنج - الجزء الأول</title>
<!-- روابط مكتبة الشطرنج -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chessboardjs/dist/chessboard-1.0.0.min.css" />
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
  }
  #board {
    width: 400px;
    margin: 20px auto;
  }
  #message {
    margin-top: 20px;
    font-size: 20px;
    color: green;
  }
  #tokenSection {
    display: none;
    margin-top: 20px;
  }
</style>
</head>
<body>

<h2>لعبة الشطرنج - الجزء الأول</h2>
<div id="board"></div>
<div id="message"></div>
<div id="tokenSection">
  <input type="text" id="inputToken" placeholder="أدخل الرمز هنا" />
  <button id="submitToken">إرسال الرمز</button>
</div>

<!-- مكتبات الشطرنج -->
<script src="https://cdn.jsdelivr.net/npm/chessboardjs/dist/chessboard-1.0.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chess.js/chess.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var game = new Chess();

    var board = Chessboard('board', {
      position: 'start',
      draggable: true,
      onDragStart: function(source, piece, position, orientation) {
        if (game.game_over()) return false;

        // منع الأبيضل من تحريك قطع الأسود والعكس
        if (
          (game.turn() === 'w' && piece.search(/^b/) !== -1) ||
          (game.turn() === 'b' && piece.search(/^w/) !== -1)
        ) {
          return false;
        }
      },
      onDrop: function(source, target) {
        var move = game.move({
          from: source,
          to: target,
          promotion: 'q' // الترقية إلى الوزير
        });

        if (move === null) return 'snapback';

        // التحقق من الشمال
        if (game.in_checkmate()) {
          document.getElementById('message').innerHTML = 'مبروك! لقد فزت. الرمز هو: <b>12345</b>';
          document.getElementById('tokenSection').style.display = 'block';
          if (board) { board.destroy(); }
        }
      },
      orientation: 'white'
    });

    document.getElementById('submitToken').onclick = function() {
      var enteredToken = document.getElementById('inputToken').value.trim();
      if (enteredToken === '12345') {
        window.location.href = 'second.html'; // الصفحة الثانية
      } else {
        alert('رمز غير صحيح، حاول مرة أخرى.');
      }
    };
  });
</script>

</body>
</html>
